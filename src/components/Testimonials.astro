---
import en from '../i18n/messages/en.json';
import es from '../i18n/messages/es.json';

const lang = Astro.url.pathname.includes('/es') ? 'es' : 'en';
const t = lang === 'es' ? es : en;

const testimonials = [
  {
    name: "Sarah & James",
    location: "Playa del Carmen",
    text: "Mario and Gabriela captured our day perfectly. Every time we watch our video, we're transported back to that magical moment. Their attention to detail is incredible.",
    image: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=100&h=100&fit=crop&crop=face"
  },
  {
    name: "Emily & David",
    location: "Tulum",
    text: "We couldn't have asked for a better team. They made us feel so comfortable and the final film exceeded all our expectations. Truly cinematic!",
    image: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop&crop=face"
  },
  {
    name: "Ana & Carlos",
    location: "Cancún",
    text: "The way they told our story was absolutely beautiful. Our families cry every time they watch it. Worth every penny!",
    image: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100&h=100&fit=crop&crop=face"
  },
  {
    name: "Laura & Michael",
    location: "Riviera Maya",
    text: "Professional, creative, and so easy to work with. They truly understood our vision and delivered beyond our dreams.",
    image: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=100&h=100&fit=crop&crop=face"
  },
  {
    name: "María & José",
    location: "Isla Mujeres",
    text: "Our wedding film is a masterpiece. The emotions, the music, everything was perfect. We've watched it a hundred times!",
    image: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face"
  }
];
---

<section class="bg-blush-bg py-16" id="testimonials">
  <div class="max-w-screen-lg mx-auto px-4">
    <div class="text-center mb-12">
      <h2 class="text-4xl md:text-5xl font-main text-taupe mb-4">
        {t.testimonials?.title || "What Our Couples Say"}
      </h2>
      <p class="text-sm text-taupe/70">
        {t.testimonials?.subtitle || "Real stories from real couples"}
      </p>
    </div>

    <!-- Slider container -->
    <div class="flex items-center gap-4">
      <!-- Prev arrow -->
      <button 
        id="prev-btn"
        class="bg-white shadow-lg rounded-full p-2 hover:bg-gray-50 transition-colors hidden md:block flex-shrink-0"
        aria-label="Previous"
      >
        <svg class="w-4 h-4 text-taupe" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </button>

      <!-- Cards slider -->
      <div id="testimonials-slider" class="flex gap-4 overflow-x-auto snap-x snap-mandatory scrollbar-hide pb-2 flex-1">
        {testimonials.map((testimonial) => (
          <div class="bg-white p-5 rounded-lg shadow-sm w-[calc(100%-16px)] md:w-[calc(33.333%-11px)] snap-start flex-shrink-0 aspect-[4/3] flex flex-col justify-between">
            <p class="text-xs text-taupe/80 leading-relaxed italic">
              "{testimonial.text}"
            </p>
            <div class="flex items-center mt-3">
              <img 
                src={testimonial.image} 
                alt={testimonial.name}
                class="w-10 h-10 rounded-full object-cover mr-3"
              />
              <div>
                <h4 class="font-medium text-taupe text-sm">{testimonial.name}</h4>
                <p class="text-xs text-taupe/60">{testimonial.location}</p>
              </div>
            </div>
          </div>
        ))}
      </div>

      <!-- Next arrow -->
      <button 
        id="next-btn"
        class="bg-white shadow-lg rounded-full p-2 hover:bg-gray-50 transition-colors hidden md:block flex-shrink-0"
        aria-label="Next"
      >
        <svg class="w-4 h-4 text-taupe" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
    </div>
  </div>
</section>

<style>
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
</style>

<script>
  const slider = document.getElementById('testimonials-slider');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  
  const cardWidth = slider ? slider.querySelector('div')?.offsetWidth || 300 : 300;
  const scrollAmount = cardWidth + 16;
  
  prevBtn?.addEventListener('click', () => {
    slider?.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
  });
  
  nextBtn?.addEventListener('click', () => {
    slider?.scrollBy({ left: scrollAmount, behavior: 'smooth' });
  });
</script>
